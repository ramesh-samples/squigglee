- hosts: tag_ring_position_{{logicalNumber}}:&tag_cluster_{{cluster}}
  user: ec2-user 
  tasks:
     - debug: msg="Starting Services at Logical Node = {{logicalNumber}}"
#     - debug: var=logicalNumber
#     - debug: var=hostvars[inventory_hostname]['ec2_tag_ring_position']
     - shell: "ps aux | grep com.squigglee.jobs.task.N[o]deUpdateTask | awk {'print $2'} | xargs sudo kill -9"
       sudo: yes
       ignore_errors: True  
       
     - shell: "nohup java -cp squiggleejobs.jar -Dlog4j.configuration=file:log4j.properties -DtsrPropFile=LocalNodeProperties.config -Dzookeeper.sasl.client=false com.squigglee.jobs.task.NodeUpdateTask &"
       args:
         chdir: /opt/tsr/services
       sudo: yes
     
#     - shell: "ps aux | grep com.squigglee.jobs.launchers.I[n]dexTaskLauncher | awk {'print $2'} | xargs sudo kill -9"    
#       sudo: yes
#       ignore_errors: True  

#     - shell: "nohup java -cp squiggleejobs.jar -Dlog4j.configuration=file:log4j.properties -DtsrPropFile=LocalNodeProperties.config -Dzookeeper.sasl.client=false com.squigglee.jobs.launchers.IndexTaskLauncher &"
#       args:
#         chdir: /opt/tsr/services 
#       sudo: yes
     
#     - shell: "ps aux | grep com.squigglee.jobs.launchers.O[v]erlayTaskLauncher | awk {'print $2'} | xargs sudo kill -9"
#       sudo: yes
#       ignore_errors: True  

#     - shell: "nohup java -cp squiggleejobs.jar -Dlog4j.configuration=file:log4j.properties -DtsrPropFile=LocalNodeProperties.config -Dzookeeper.sasl.client=false com.squigglee.jobs.launchers.OverlayTaskLauncher &"
#       args:
#         chdir: /opt/tsr/services
#       sudo: yes
     
     - shell: "ps aux | grep com.squigglee.jobs.launchers.P[i]ngTaskLauncher | awk {'print $2'} | xargs sudo kill -9"
       sudo: yes
       ignore_errors: True  

     - shell: "nohup java -cp squiggleejobs.jar -Dlog4j.configuration=file:log4j.properties -DtsrPropFile=LocalNodeProperties.config -Dzookeeper.sasl.client=false com.squigglee.jobs.launchers.PingTaskLauncher &"
       args:
         chdir: /opt/tsr/services
       sudo: yes

     - shell: "ps aux | grep com.squigglee.jobs.indexing.Indexing[M]aster | awk {'print $2'} | xargs sudo kill -9"
       sudo: yes
       ignore_errors: True  
       
     - pause: seconds=10       

     - shell: "nohup java -cp squiggleejobs.jar -Dlog4j.configuration=file:log4j.properties -DtsrPropFile=LocalNodeProperties.config -Dzookeeper.sasl.client=false com.squigglee.jobs.indexing.IndexingMaster &"
       args:
         chdir: /opt/tsr/services
       sudo: yes
        
     - shell: "ps aux | grep com.squigglee.jobs.indexing.Indexing[W]orker | awk {'print $2'} | xargs sudo kill -9"
       sudo: yes
       ignore_errors: True  

     - pause: seconds=10

     - shell: "nohup java -cp squiggleejobs.jar -Dlog4j.configuration=file:log4j.properties -DtsrPropFile=LocalNodeProperties.config -Dzookeeper.sasl.client=false com.squigglee.jobs.indexing.IndexingWorker ptrn &"
       args:
         chdir: /opt/tsr/services
       sudo: yes
       
     - shell: "nohup java -cp squiggleejobs.jar -Dlog4j.configuration=file:log4j.properties -DtsrPropFile=LocalNodeProperties.config -Dzookeeper.sasl.client=false com.squigglee.jobs.indexing.IndexingWorker skchEX &"
       args:
         chdir: /opt/tsr/services
       sudo: yes       
       
     - shell: "ps aux | grep com.squigglee.jobs.sync.Sync[W]orker | awk {'print $2'} | xargs sudo kill -9"
       sudo: yes
       ignore_errors: True  
       
     - pause: seconds=10
     
     - shell: "nohup java -cp squiggleejobs.jar -Dlog4j.configuration=file:log4j.properties -DtsrPropFile=LocalNodeProperties.config -Dzookeeper.sasl.client=false com.squigglee.jobs.sync.SyncWorker &"
       args:
         chdir: /opt/tsr/services
       sudo: yes
       
     - shell: "ps aux | grep com.squigglee.jobs.event.Event[W]orker | awk {'print $2'} | xargs sudo kill -9"
       sudo: yes
       ignore_errors: True 
       
     - shell: "ps aux | grep com.squigglee.jobs.event.Event[S]weeper | awk {'print $2'} | xargs sudo kill -9"
       sudo: yes
       ignore_errors: True       
              
     - pause: seconds=10
     
     - shell: "nohup java -cp squiggleejobs.jar -Dlog4j.configuration=file:log4j.properties -DtsrPropFile=LocalNodeProperties.config -Dzookeeper.sasl.client=false com.squigglee.jobs.event.EventWorker &"
       args:
         chdir: /opt/tsr/services
       sudo: yes
       
     - shell: "nohup java -cp squiggleejobs.jar -Dlog4j.configuration=file:log4j.properties -DtsrPropFile=LocalNodeProperties.config -Dzookeeper.sasl.client=false com.squigglee.jobs.event.EventSweeper &"
       args:
         chdir: /opt/tsr/services
       sudo: yes
       
       